%INTERP5DOF_TEST  simple test case for five degree-of-freedom GB property interpolation

% random 5DOF parameters
qm = [0.2995 0.4914 -0.1899 -0.7954
    0.3345 0.1024 0.6526 -0.6721
    0.3288 0.0272 0.8723 -0.3608
    0.4590 0.7375 -0.4617 -0.1796
    0.3767 -0.1359 -0.8795 0.2570
    0.2678 0.4483 -0.0495 -0.8514
    0.4233 0.1687 0.6504 0.6078
    0.6080 -0.1320 -0.6703 -0.4046
    0.7767 0.5224 0.2634 -0.2332
    0.5892 0.3182 0.3116 -0.6741];

nA = [0.1575 0.2978 0.9415
    - 0.5182 -0.5361 -0.6664
    0.3001 -0.0596 -0.9520
    - 0.0861 -0.5762 -0.8127
    0.9868 0.0757 -0.1428
    - 0.7643 0.6124 -0.2023
    0.1244 0.6539 -0.7463
    0.5912 0.5242 0.6130
    - 0.2575 -0.4759 -0.8409
    - 0.7664 0.2206 -0.6033
    - 0.5601 -0.5900 -0.5815];

y = [1.0920
    1.2679
    1.2818
    1.2218
    1.1875
    1.2920
    1.0594
    1.1558
    1.2405
    1.2237
    1.2357];

qm2 = [0.7108 0.4275 -0.0729 0.5538
    0.4843 -0.1206 0.5403 -0.6775
    0.4622 -0.7206 -0.2029 0.4754
    0.1627 0.5945 -0.6567 -0.4345
    0.5182 0.1019 -0.0543 -0.8474
    0.3406 0.9390 0.0303 -0.0358
    0.6842 -0.1173 -0.7187 0.0381
    0.3695 -0.0570 0.6786 -0.6322
    0.2719 -0.3672 -0.5529 0.6968
    0.0181 0.4028 0.9150 -0.0128
    0.9481 -0.1687 -0.0199 -0.2690];

nA2 = [0.1575 0.2978 0.9415
    - 0.5182 -0.5361 -0.6664
    0.3001 -0.0596 -0.9520
    - 0.0861 -0.5762 -0.8127
    0.9868 0.0757 -0.1428
    - 0.7643 0.6124 -0.2023
    0.1244 0.6539 -0.7463
    0.5912 0.5242 0.6130
    - 0.2575 -0.4759 -0.8409
    - 0.7664 0.2206 -0.6033
    - 0.5601 -0.5900 -0.5815];

%% Interpolation
tic
numNearest = 5;
mygpropts = {'PredictMethod', 'exact'};
[ypred, interpfn, mdl, mdlpars] = interp5DOF(qm, nA, y, 'nNN', numNearest, 'mygpropts', mygpropts);
toc

tic
y_pred = interpfn(qm2, nA2);
toc
